@model dynamic
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    ViewData["Title"] = "Th√™m/S·ª≠a b√†i b√°o";
}

<style>
    .toolbar {
        border: 1px solid #ccc;
        border-bottom: none;
        padding: 8px;
        background: #f9f9f9;
        border-radius: 4px 4px 0 0;
        display: flex;
        gap: 8px;
        align-items: center;
        flex-wrap: wrap;
    }
    
    .toolbar button, .toolbar select {
        padding: 4px 8px;
        border: 1px solid #ccc;
        background: white;
        border-radius: 3px;
        cursor: pointer;
        font-size: 12px;
    }
    
    .toolbar button:hover {
        background: #e9e9e9;
    }
    
    .content-editor {
        border: 1px solid #ccc;
        padding: 12px;
        min-height: 300px;
        border-radius: 0 0 4px 4px;
        background: white;
        outline: none;
        line-height: 1.5;
    }
    
    .content-editor:focus {
        border-color: #2563eb;
        box-shadow: 0 0 0 1px #2563eb;
    }
    
    .image-preview {
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 8px;
        margin-top: 8px;
        background: #f9f9f9;
        display: none;
    }
    
    .image-preview.show {
        display: block;
    }
    
    .image-preview img {
        max-width: 200px;
        max-height: 150px;
        border-radius: 4px;
    }
    
    .primary-image-preview {
        border: 2px solid #f59e0b;
        padding: 8px;
        border-radius: 4px;
        background: #fef3c7;
        margin-top: 8px;
    }
    
    .primary-image-preview img {
        max-width: 200px;
        max-height: 150px;
        border-radius: 4px;
    }
</style>

<div class="container mx-auto py-8 px-4 max-w-2xl">
    <div class="bg-white rounded-lg shadow-lg p-8">
        <h1 class="text-2xl font-bold mb-6" id="formTitle">Th√™m/S·ª≠a b√†i b√°o</h1>
        <form id="newsForm" autocomplete="off">
            <input type="hidden" id="newsId" name="id">
            <div class="mb-4">
                <label class="block mb-1 font-medium">Ti√™u ƒë·ªÅ <span class="text-red-600">*</span></label>
                <input type="text" id="title" name="title" class="w-full border border-gray-300 rounded px-3 py-2" required>
            </div>
            <div class="mb-4">
                <label class="block mb-1 font-medium">T√≥m t·∫Øt</label>
                <textarea id="summary" name="summary" rows="2" class="w-full border border-gray-300 rounded px-3 py-2"></textarea>
            </div>
            <div class="mb-4">
                <label class="block mb-1 font-medium">N·ªôi dung <span class="text-red-600">*</span></label>
                <div class="toolbar">
                    <button type="button" onclick="formatText('bold')" title="In ƒë·∫≠m"><b>B</b></button>
                    <button type="button" onclick="formatText('italic')" title="In nghi√™ng"><i>I</i></button>
                    <button type="button" onclick="formatText('underline')" title="G·∫°ch d∆∞·ªõi"><u>U</u></button>
                    <button type="button" onclick="formatText('justifyLeft')" title="CƒÉn tr√°i">‚Üê</button>
                    <button type="button" onclick="formatText('justifyCenter')" title="CƒÉn gi·ªØa">‚ü∑</button>
                    <button type="button" onclick="formatText('justifyRight')" title="CƒÉn ph·∫£i">‚Üí</button>
                    <select onchange="changeFontSize(this.value)" title="C·ª° ch·ªØ">
                        <option value="">C·ª° ch·ªØ</option>
                        <option value="12px">12px</option>
                        <option value="14px">14px</option>
                        <option value="16px">16px</option>
                        <option value="20px">20px</option>
                        <option value="24px">24px</option>
                        <option value="32px">32px</option>
                    </select>
                    <input type="file" id="contentImage" accept="image/*" style="display: none;" onchange="previewContentImage()">
                    <button type="button" onclick="document.getElementById('contentImage').click()" title="Ch√®n ·∫£nh">üì∑ Ch√®n ·∫£nh</button>
                </div>
                <div id="content" contenteditable="true" class="content-editor" placeholder="Nh·∫≠p n·ªôi dung b√†i vi·∫øt..."></div>
                <div id="contentImagePreview" class="image-preview">
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-medium">Preview ·∫£nh:</span>
                        <button type="button" onclick="cancelContentImagePreview()" class="text-red-500 hover:text-red-700">‚úï</button>
                    </div>
                    <div id="contentImageContainer"></div>
                    <div class="mt-2">
                        <button type="button" onclick="insertImageAtCursor()" class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600">Ch√®n v√†o v·ªã tr√≠ con tr·ªè</button>
                    </div>
                </div>
            </div>
            <div class="mb-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block mb-1 font-medium">T√°c gi·∫£</label>
                    <input type="text" id="authorName" name="authorName" class="w-full border border-gray-300 rounded px-3 py-2">
                </div>
                <div>
                    <label class="block mb-1 font-medium">Ngu·ªìn</label>
                    <input type="text" id="source" name="source" class="w-full border border-gray-300 rounded px-3 py-2">
                </div>
            </div>
            <div class="mb-4">
                <label class="block mb-1 font-medium">Tr·∫°ng th√°i</label>
                <select id="status" name="status" class="w-full border border-gray-300 rounded px-3 py-2">
                    <option value="0">Nh√°p</option>
                    <option value="1">ƒê√£ xu·∫•t b·∫£n</option>
                </select>
            </div>
            <div class="mb-4">
                <label class="block mb-1 font-medium">·∫¢nh ƒë·∫°i di·ªán <span class="text-orange-500">(·∫¢nh n√†y s·∫Ω ƒë∆∞·ª£c ƒë√°nh d·∫•u l√†m ·∫£nh ch√≠nh)</span></label>
                <input type="file" id="newsImage" accept="image/*" class="block" onchange="previewPrimaryImage()">
                <div id="primaryImagePreview" class="primary-image-preview" style="display: none;">
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-medium text-orange-700">üåü ·∫¢nh ƒë·∫°i di·ªán (Primary):</span>
                        <button type="button" onclick="cancelPrimaryImagePreview()" class="text-red-500 hover:text-red-700">‚úï</button>
                    </div>
                    <div id="primaryImageContainer"></div>
                </div>
            </div>
            <div class="flex justify-end gap-2">
                <a href="/Admin/NewsManagement" class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded">Quay l·∫°i</a>
                <button type="submit" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded font-semibold">L∆∞u</button>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="~/js/Admin/CreateOrEditNews.js"></script>
}